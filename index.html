<script src="https://cdn.paddle.com/paddle/paddle.js"></script>

<script>
  const PADDLE_PRICE_ID = 'pri_01kft4eh4rcjcx5pq2tvhwsw27';
  let hasPaid = localStorage.getItem('unlocked') === 'true';

  function setUnlocked(state) {
    hasPaid = state;
    if (state) localStorage.setItem('unlocked', 'true');
    else localStorage.removeItem('unlocked');
    updateUnlockUI();
  }

  // Set environment
  Paddle.Environment.set('sandbox');

  // Listen for checkout completion
  window.addEventListener('message', function(e) {
    if (!e.data || !e.data.event) return;
    if (e.data.event === 'Checkout.Complete') {
      console.log('Payment completed! Unlocking...');
      setUnlocked(true);
    }
  });

  document.addEventListener('DOMContentLoaded', () => {
    const unlockBtn = document.getElementById('unlockBtn');
    unlockBtn.addEventListener('click', () => {
      Paddle.Checkout.open({
        items: [{ priceId: PADDLE_PRICE_ID, quantity: 1 }]
      });
    });
  });
</script>
